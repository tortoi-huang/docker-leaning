version: '3'
services:
  # zookeeper template
  zookeeper:
    image: apachepulsar/pulsar:3.1.1
    networks:
      - pulsar
    environment:
      - ZOOKEEPER_SERVERS=zookeeper-1,zookeeper-2,zookeeper-3
      # - PULSAR_MEM=-Xms256m -Xmx256m -XX:MaxDirectMemorySize=256m
      - PULSAR_MEM=-Xms64m -Xmx64m -XX:MaxDirectMemorySize=64m
    command: >
      bash -c "bin/apply-config-from-env.py conf/zookeeper.conf && \
             bin/generate-zookeeper-config.sh conf/zookeeper.conf && \
             exec bin/pulsar zookeeper"
    healthcheck:
      test: ["CMD", "bin/pulsar-zookeeper-ruok.sh"]
      interval: 10s
      timeout: 5s
      retries: 30
  zoonavigator-temp:
    hostname: zoonavigator
    image: elkozmon/zoonavigator:latest
    networks:
      - pulsar
    environment:
      - HTTP_PORT=9000